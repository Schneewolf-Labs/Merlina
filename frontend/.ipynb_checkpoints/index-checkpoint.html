<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Merlina - Magical Model Training ‚ú®</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <div class="logo">
                <span class="wizard-hat">üßô‚Äç‚ôÄÔ∏è</span>
                <h1>Merlina</h1>
                <span class="tagline">Magical Model Training</span>
            </div>
        </header>

        <!-- Main Content -->
        <main>
            <!-- Training Configuration -->
            <section id="config-section" class="card">
                <h2>‚ú® Cast Your Training Spell</h2>
                <form id="training-form">
                    <!-- Model Selection -->
                    <div class="form-group">
                        <label>üìö Base Model</label>
                        <select id="base-model" class="magic-select">
                            <option value="meta-llama/Meta-Llama-3-8B-Instruct">Llama 3 8B ü¶ô</option>
                            <option value="meta-llama/Llama-3.2-3B-Instruct">Llama 3.2 3B ü¶ô</option>
                            <option value="mistralai/Mistral-7B-Instruct-v0.3">Mistral 7B üå™Ô∏è</option>
                            <option value="Qwen/Qwen2.5-7B-Instruct">Qwen 2.5 7B üêâ</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label>üè∑Ô∏è Output Model Name</label>
                        <input type="text" id="output-name" placeholder="My-Magical-Model" class="magic-input" required>
                    </div>

                    <!-- LoRA Configuration -->
                    <div class="spell-section">
                        <h3>ü™Ñ LoRA Enchantments</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Rank (r)</label>
                                <input type="number" id="lora-r" value="64" min="8" max="256" class="magic-input">
                            </div>
                            <div class="form-group">
                                <label>Alpha</label>
                                <input type="number" id="lora-alpha" value="32" min="8" max="256" class="magic-input">
                            </div>
                            <div class="form-group">
                                <label>Dropout</label>
                                <input type="number" id="lora-dropout" value="0.05" min="0" max="0.5" step="0.01" class="magic-input">
                            </div>
                        </div>
                    </div>

                    <!-- Training Parameters -->
                    <div class="spell-section">
                        <h3>‚öóÔ∏è Training Potions</h3>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Learning Rate</label>
                                <input type="number" id="learning-rate" value="0.000005" step="0.000001" class="magic-input">
                            </div>
                            <div class="form-group">
                                <label>Epochs</label>
                                <input type="number" id="epochs" value="2" min="1" max="10" class="magic-input">
                            </div>
                            <div class="form-group">
                                <label>Batch Size</label>
                                <input type="number" id="batch-size" value="1" min="1" max="8" class="magic-input">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Gradient Accumulation</label>
                                <input type="number" id="grad-accum" value="16" min="1" max="128" class="magic-input">
                            </div>
                            <div class="form-group">
                                <label>Max Length</label>
                                <input type="number" id="max-length" value="2048" min="512" max="8192" step="512" class="magic-input">
                            </div>
                            <div class="form-group">
                                <label>ORPO Beta</label>
                                <input type="number" id="beta" value="0.1" min="0.01" max="1" step="0.01" class="magic-input">
                            </div>
                        </div>
                    </div>

                    <!-- Options -->
                    <div class="spell-section">
                        <h3>üåü Magical Options</h3>
                        <div class="checkbox-group">
                            <label class="magic-checkbox">
                                <input type="checkbox" id="use-4bit" checked>
                                <span>Use 4-bit Quantization üóúÔ∏è</span>
                            </label>
                            <label class="magic-checkbox">
                                <input type="checkbox" id="use-wandb" checked>
                                <span>Enable Weights & Biases üìä</span>
                            </label>
                            <label class="magic-checkbox">
                                <input type="checkbox" id="push-hub">
                                <span>Push to HuggingFace Hub ü§ó</span>
                            </label>
                        </div>
                    </div>

                    <!-- API Keys -->
                    <div class="spell-section" id="api-keys">
                        <h3>üîë Secret Ingredients</h3>
                        <div class="form-group">
                            <label>W&B API Key (optional)</label>
                            <input type="password" id="wandb-key" placeholder="Your W&B key" class="magic-input">
                        </div>
                        <div class="form-group" id="hf-token-group" style="display: none;">
                            <label>HuggingFace Token</label>
                            <input type="password" id="hf-token" placeholder="Your HF token" class="magic-input">
                        </div>
                    </div>

                    <button type="submit" class="cast-button">
                        <span class="button-icon">ü™Ñ</span>
                        Cast Training Spell
                    </button>
                </form>
            </section>

            <!-- Active Jobs -->
            <section id="jobs-section" class="card" style="display: none;">
                <h2>üîÆ Active Spells</h2>
                <div id="jobs-container"></div>
            </section>
        </main>

        <!-- Job Monitoring Modal -->
        <div id="job-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2>üìä Spell Progress</h2>
                <div id="job-details">
                    <div class="job-header">
                        <h3 id="job-name"></h3>
                        <span id="job-id" class="job-id"></span>
                    </div>
                    
                    <div class="progress-section">
                        <div class="progress-bar">
                            <div id="progress-fill" class="progress-fill"></div>
                            <span id="progress-text" class="progress-text">0%</span>
                        </div>
                        <div id="status-text" class="status-text"></div>
                    </div>

                    <div class="metrics-grid">
                        <div class="metric-card">
                            <span class="metric-label">Current Step</span>
                            <span id="current-step" class="metric-value">-</span>
                        </div>
                        <div class="metric-card">
                            <span class="metric-label">Loss</span>
                            <span id="loss-value" class="metric-value">-</span>
                        </div>
                        <div class="metric-card">
                            <span class="metric-label">Status</span>
                            <span id="job-status" class="metric-value">-</span>
                        </div>
                    </div>

                    <div class="action-buttons">
                        <a id="wandb-link" href="#" target="_blank" class="action-button" style="display: none;">
                            üìä View in W&B
                        </a>
                        <button id="stop-button" class="action-button danger">
                            üõë Stop Training
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Notification Toast -->
        <div id="toast" class="toast"></div>
    </div>

    <script src="script.js"></script>
</body>
</html>